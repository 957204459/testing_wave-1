# 被动web扫描器
### 概括
本资深挖掘机操作手一直在思考如何能将工作效率提升十倍以上，为了这个目的我一直在思考，走路时 拉屎时 吃饭时 开车时 睡觉时，真的是做梦都在想这个问题，所以在挖洞的过程中本操作手一直在总结经验，然后就出现了这个能提升挖洞效率的工具。

### 功能介绍
基于实战需求的功能介绍，后端漏洞 xss\sql\命令注入等，修改http请求包参数而判断漏洞存在的漏洞类型，在平常的漏洞挖掘中基本都是很千篇一律的重复的工作,***说直白点，就是一个通过python3处理自动https/s请求包的工具***。  

如: xss反射漏洞的判断检测就是在http请求参数后面追加xss-payload，得到http响应包后来判断是否页面存在xss反射漏洞。

并且常规漏洞都是如此，修改http请求包来检测漏洞存在，无论是xss\sql\命令注入都是如此。  
***所以我的工具目的就是解放大部分的重复工作来提升挖洞效率，自动处理http请求包，在合适的位置追加漏洞测试payload,然后重放http请求包，自动判断漏洞存在。***

那么如何得到http/s请求包，分为两种模式: 
* 1.基于http/s代理 
* 2.基于burp suite

两种模式两种实战需求，1基于http/s代理这个相似工具做的挺多的，就是检测每一个走代理的http请求包是否存在漏洞，2基于burp的是把burp的指定的单个http请求包一键导出进行漏洞检测。

### 技术实现思路

* 1.得到http/s请求包

  1).http代理模式

  2).burp插件模式

* 2.漏洞检测  
  前面有说过漏洞检测核心就是在http请求包里追加漏洞检测用的payload,追根到底就是增/删/改http请求包,进行请求重放，判断响应包来检测漏洞存在。  
  
    三种payload追加方式:  
    1). xss反射:  http://www.vultest.com/reflect-xss.php?xss=a   在xss参数后面追加```"'<guimaizixss>\```来检测是否存在xss反射漏洞。  
    2). header包  
    3). json方式数据传输  

    三种漏洞判断方式:  
   1). http/s响应包数据特征判断  
   2). http/s响应包时间延时判断  
   3). dnslog/httplog的判断  

   上面三种payload追加方式 以及三种漏洞判断方式，基本已经涵盖了大多数漏洞挖掘者的需求了。


* 3.插件化漏洞检测  
    因各种漏洞测试方法的不同，进而插件化漏洞检测方式，遍历追加常规参数如 a=1&b=lllxxx 与 {"a":"1,"b":"lllxx"} 之类方式。
* 4.去重  
    避免重复的漏洞测试，降低发包量提高工具效率 以及被waf风控之类发现的可能性，在常规情况下单个web接口单个参数下只测试一次。

### 实战需求